function [xnext, A, SQ] = wamv_processModel(in)

global param

eta = in(1:6);
N = eta(1); E = eta(2); D = eta(3); phi = eta(4); theta = eta(5); psi = eta(6);
nu = in(7:12);
u = nu(1); v = nu(2); w = nu(3); p = nu(4); q = nu(5); r = nu(6);
deta = in(13:18);
dnu = in(19:24);

xnext = [eta;nu] + [deta;dnu]*param.WAMV.T;

%linearisation about x 

Process_Jacobian = [0, 0, 0,   v*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) + w*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)), w*cos(phi)*cos(psi)*cos(theta) - u*cos(psi)*sin(theta) + v*cos(psi)*cos(theta)*sin(phi), w*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - v*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)) - u*cos(theta)*sin(psi), cos(psi)*cos(theta), cos(psi)*sin(phi)*sin(theta) - cos(phi)*sin(psi), sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta), 0,                   0,                   0;
 0, 0, 0, - v*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - w*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta)), w*cos(phi)*cos(theta)*sin(psi) - u*sin(psi)*sin(theta) + v*cos(theta)*sin(phi)*sin(psi), w*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta)) - v*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta)) + u*cos(psi)*cos(theta), cos(theta)*sin(psi), cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta), cos(phi)*sin(psi)*sin(theta) - cos(psi)*sin(phi), 0,                   0,                   0;
 0, 0, 0,                                                                 v*cos(phi)*cos(theta) - w*cos(theta)*sin(phi),                          - u*cos(theta) - w*cos(phi)*sin(theta) - v*sin(phi)*sin(theta),                                                                                                                                   0,         -sin(theta),                              cos(theta)*sin(phi),                              cos(phi)*cos(theta), 0,                   0,                   0;
 0, 0, 0,                                                                 q*cos(phi)*tan(theta) - r*sin(phi)*tan(theta),                           r*cos(phi)*(tan(theta)^2 + 1) + q*sin(phi)*(tan(theta)^2 + 1),                                                                                                                                   0,                   0,                                                0,                                                0, 1, sin(phi)*tan(theta), cos(phi)*tan(theta);
 0, 0, 0,                                                                                     - r*cos(phi) - q*sin(phi),                                                                                       0,                                                                                                                                   0,                   0,                                                0,                                                0, 0,            cos(phi),           -sin(phi);
 0, 0, 0,                                                             (q*cos(phi))/cos(theta) - (r*sin(phi))/cos(theta),             (r*cos(phi)*sin(theta))/cos(theta)^2 + (q*sin(phi)*sin(theta))/cos(theta)^2,                                                                                                                                   0,                   0,                                                0,                                                0, 0, sin(phi)/cos(theta), cos(phi)/cos(theta);
 0, 0, 0, 0, 0, 0,                                                                                                                                                                                                                                                     ((25*param.WAMV.Ndr - 25*param.WAMV.Iy + param.WAMV.m)*(param.WAMV.Xu + param.WAMV.Xuu*abs(u) + param.WAMV.Xuu*u*sign(u)))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2),                                                                         ((param.WAMV.m*r - r*(param.WAMV.Ydr + param.WAMV.Ydv))*(25*param.WAMV.Ndr - 25*param.WAMV.Iy + param.WAMV.m))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2) + (param.WAMV.m^2*r)/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2), 0, (5*param.WAMV.Iz*param.WAMV.m*r)/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2) - (param.WAMV.m*r*(25*param.WAMV.Ndr - 25*param.WAMV.Iy + param.WAMV.m))/(5*(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2)),                                                                                                                                                                                                                         0,                                                                                                                                                                                       (5*param.WAMV.m*(param.WAMV.Iz*p + (param.WAMV.m*v)/5))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2) - ((25*param.WAMV.Ndr - 25*param.WAMV.Iy + param.WAMV.m)*(param.WAMV.Ydr*v + param.WAMV.Ydv*v + (param.WAMV.m*p)/5 - (2*param.WAMV.m*r)/5 - param.WAMV.m*v))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2);
 0, 0, 0, 0, 0, 0,                                            - (5*(5*param.WAMV.Ix*param.WAMV.Ydr - param.WAMV.Ix*param.WAMV.m)*(param.WAMV.Ydr*r - param.WAMV.Xdu*v + param.WAMV.Ydv*v - (param.WAMV.m*r)/5))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) - (param.WAMV.Iz*param.WAMV.m^2*r)/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) - (25*param.WAMV.Ix*param.WAMV.Iz*(param.WAMV.Xdu*r - param.WAMV.m*r))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m),                   (5*(5*param.WAMV.Ix*param.WAMV.Ydr - param.WAMV.Ix*param.WAMV.m)*(param.WAMV.Xdu*u - param.WAMV.Ydv*u))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) - (25*param.WAMV.Ix*param.WAMV.Iz*(param.WAMV.Yv + param.WAMV.Yvv*abs(v) + param.WAMV.Yvv*v*sign(v)))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m), 0,                                                                                                                                                                       0,                                          (5*param.WAMV.Iz^2*param.WAMV.m*r)/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) + (5*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m*r)/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m),                                        (25*param.WAMV.Ix*param.WAMV.Iz*((param.WAMV.m*q)/5 - param.WAMV.Xdu*u + param.WAMV.m*u))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) - (5*(5*param.WAMV.Ix*param.WAMV.Ydr - param.WAMV.Ix*param.WAMV.m)*(param.WAMV.Nr + u*(param.WAMV.Ydr - param.WAMV.m/5) + param.WAMV.Nrr*abs(r) + param.WAMV.Nrr*r*sign(r)))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) + (5*param.WAMV.Iz*param.WAMV.m*(param.WAMV.Iz*q - (param.WAMV.m*u)/5))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m);
 0, 0, 0, 0, 0, 0,                                                                                                                                                                                                                                                                        (param.WAMV.m*(param.WAMV.Xu + param.WAMV.Xuu*abs(u) + param.WAMV.Xuu*u*sign(u)))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2),                                                                                    (param.WAMV.m*(param.WAMV.m*r - r*(param.WAMV.Ydr + param.WAMV.Ydv)))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2) + (param.WAMV.m*r*(param.WAMV.Xdu - param.WAMV.m))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2), 0,            (5*param.WAMV.Iz*r*(param.WAMV.Xdu - param.WAMV.m))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2) - (param.WAMV.m^2*r)/(5*(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2)),                                                                                                                                                                                                                         0,                                                                                                                                                                                                  (5*(param.WAMV.Xdu - param.WAMV.m)*(param.WAMV.Iz*p + (param.WAMV.m*v)/5))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2) - (param.WAMV.m*(param.WAMV.Ydr*v + param.WAMV.Ydv*v + (param.WAMV.m*p)/5 - (2*param.WAMV.m*r)/5 - param.WAMV.m*v))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2);
 0, 0, 0, 0, 0, 0, (param.WAMV.m*r*(25*param.WAMV.Ydr^2 - 10*param.WAMV.Ydr*param.WAMV.m + param.WAMV.m^2 - 25*param.WAMV.Iz*param.WAMV.m + 25*param.WAMV.Iz*param.WAMV.Ydv))/(5*(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m)) - (5*param.WAMV.Iz*param.WAMV.m*(param.WAMV.Xdu*r - param.WAMV.m*r))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) - ((- param.WAMV.m^2 + 5*param.WAMV.Ydr*param.WAMV.m)*(param.WAMV.Ydr*r - param.WAMV.Xdu*v + param.WAMV.Ydv*v - (param.WAMV.m*r)/5))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m),                       ((- param.WAMV.m^2 + 5*param.WAMV.Ydr*param.WAMV.m)*(param.WAMV.Xdu*u - param.WAMV.Ydv*u))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) - (5*param.WAMV.Iz*param.WAMV.m*(param.WAMV.Yv + param.WAMV.Yvv*abs(v) + param.WAMV.Yvv*v*sign(v)))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m), 0,                                                                                                                                                                       0, (param.WAMV.Iz*param.WAMV.m^2*r)/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) - (param.WAMV.Iz*r*(25*param.WAMV.Ydr^2 - 10*param.WAMV.Ydr*param.WAMV.m + param.WAMV.m^2 - 25*param.WAMV.Iz*param.WAMV.m + 25*param.WAMV.Iz*param.WAMV.Ydv))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m), (5*param.WAMV.Iz*param.WAMV.m*((param.WAMV.m*q)/5 - param.WAMV.Xdu*u + param.WAMV.m*u))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) - ((- param.WAMV.m^2 + 5*param.WAMV.Ydr*param.WAMV.m)*(param.WAMV.Nr + u*(param.WAMV.Ydr - param.WAMV.m/5) + param.WAMV.Nrr*abs(r) + param.WAMV.Nrr*r*sign(r)))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) - ((param.WAMV.Iz*q - (param.WAMV.m*u)/5)*(25*param.WAMV.Ydr^2 - 10*param.WAMV.Ydr*param.WAMV.m + param.WAMV.m^2 - 25*param.WAMV.Iz*param.WAMV.m + 25*param.WAMV.Iz*param.WAMV.Ydv))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m);
 0, 0, 0, 0, 0, 0,                                                                                                                                                                                                                                                                      (5*param.WAMV.m*(param.WAMV.Xu + param.WAMV.Xuu*abs(u) + param.WAMV.Xuu*u*sign(u)))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2),                                                                                (5*param.WAMV.m*(param.WAMV.m*r - r*(param.WAMV.Ydr + param.WAMV.Ydv)))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2) + (5*param.WAMV.m*r*(param.WAMV.Xdu - param.WAMV.m))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2), 0,               (25*param.WAMV.Iz*r*(param.WAMV.Xdu - param.WAMV.m))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2) - (param.WAMV.m^2*r)/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2),                                                                                                                                                                                                                         0,                                                                                                                                                                                               (25*(param.WAMV.Xdu - param.WAMV.m)*(param.WAMV.Iz*p + (param.WAMV.m*v)/5))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2) - (5*param.WAMV.m*(param.WAMV.Ydr*v + param.WAMV.Ydv*v + (param.WAMV.m*p)/5 - (2*param.WAMV.m*r)/5 - param.WAMV.m*v))/(25*param.WAMV.Iy*param.WAMV.Xdu - 25*param.WAMV.Ndr*param.WAMV.Xdu - 25*param.WAMV.Iy*param.WAMV.m + 25*param.WAMV.Ndr*param.WAMV.m - param.WAMV.Xdu*param.WAMV.m + 2*param.WAMV.m^2);
 0, 0, 0, 0, 0, 0,             ((param.WAMV.m^2 - 25*param.WAMV.Ix*param.WAMV.m + 25*param.WAMV.Ix*param.WAMV.Ydv)*(param.WAMV.Ydr*r - param.WAMV.Xdu*v + param.WAMV.Ydv*v - (param.WAMV.m*r)/5))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) - (param.WAMV.m*r*(- param.WAMV.m^2 + 5*param.WAMV.Ydr*param.WAMV.m))/(5*(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m)) - (5*param.WAMV.Ix*(param.WAMV.Xdu*r - param.WAMV.m*r)*(5*param.WAMV.Ydr - param.WAMV.m))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m), - ((param.WAMV.Xdu*u - param.WAMV.Ydv*u)*(param.WAMV.m^2 - 25*param.WAMV.Ix*param.WAMV.m + 25*param.WAMV.Ix*param.WAMV.Ydv))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) - (5*param.WAMV.Ix*(5*param.WAMV.Ydr - param.WAMV.m)*(param.WAMV.Yv + param.WAMV.Yvv*abs(v) + param.WAMV.Yvv*v*sign(v)))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m), 0,                                                                                                                                                                       0,                       (param.WAMV.Iz*r*(- param.WAMV.m^2 + 5*param.WAMV.Ydr*param.WAMV.m))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) + (param.WAMV.Ix*param.WAMV.m*r*(5*param.WAMV.Ydr - param.WAMV.m))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m),             ((param.WAMV.m^2 - 25*param.WAMV.Ix*param.WAMV.m + 25*param.WAMV.Ix*param.WAMV.Ydv)*(param.WAMV.Nr + u*(param.WAMV.Ydr - param.WAMV.m/5) + param.WAMV.Nrr*abs(r) + param.WAMV.Nrr*r*sign(r)))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) + ((- param.WAMV.m^2 + 5*param.WAMV.Ydr*param.WAMV.m)*(param.WAMV.Iz*q - (param.WAMV.m*u)/5))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m) + (5*param.WAMV.Ix*(5*param.WAMV.Ydr - param.WAMV.m)*((param.WAMV.m*q)/5 - param.WAMV.Xdu*u + param.WAMV.m*u))/(25*param.WAMV.Ix*param.WAMV.Ydr^2 + param.WAMV.Ix*param.WAMV.m^2 + param.WAMV.Iz*param.WAMV.m^2 + 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.Ydv - 25*param.WAMV.Ix*param.WAMV.Iz*param.WAMV.m - 10*param.WAMV.Ix*param.WAMV.Ydr*param.WAMV.m)];

A = eye(12) + Process_Jacobian*param.WAMV.T;

 SQ = diag(ones(1,12));